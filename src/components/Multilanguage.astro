---
import Badge from '../components/Badge.astro';
import { getLanguageFromURL, useTranslations } from '../i18n/utils';

const lang = getLanguageFromURL(Astro.url.pathname);
const t = useTranslations(lang);
const translations = await t('multilanguage');

const englishContent = {
  title: "Welcome to Our Website",
  description: "Explore the best services we have to offer.",
};

const arabicContent = {
  title: "مرحبًا بكم في موقعنا",
  description: "اكتشف أفضل الخدمات التي نقدمها.",
};

// Technology icons data - single set is enough now
const technologies = [
  { name: 'React', icon: 'fab fa-react' },
  { name: 'Vue', icon: 'fab fa-vuejs' },
  { name: 'Angular', icon: 'fab fa-angular' },
  { name: 'Node.js', icon: 'fab fa-node-js' },
  { name: 'Python', icon: 'fab fa-python' },
  { name: 'Django', icon: 'fab fa-python' },
  { name: 'Laravel', icon: 'fab fa-laravel' },
  { name: 'Flutter', icon: 'fab fa-flutter' },
  { name: 'Swift', icon: 'fab fa-swift' },
  { name: 'Kotlin', icon: 'fab fa-java' }
];
---

<section id="localized-section" class="relative py-32 overflow-hidden bg-gradient-to-br from-blue-50/80 via-purple-50/80 to-blue-50/80 dark:from-gray-900 dark:via-gray-800 dark:to-gray-900 font-inter">
  <!-- Background Pattern -->
  <div class="absolute inset-0">
    <!-- Gradient Overlay -->
    <div class="absolute inset-0 bg-[radial-gradient(circle_at_top_right,rgba(59,130,246,0.15),transparent_50%),radial-gradient(circle_at_bottom_left,rgba(147,51,234,0.15),transparent_50%)] dark:bg-[radial-gradient(circle_at_top_right,rgba(59,130,246,0.15),transparent_50%),radial-gradient(circle_at_bottom_left,rgba(147,51,234,0.15),transparent_50%)]"></div>
    
    <!-- Animated Gradient Orbs -->
    <div class="absolute inset-0">
      <div class="absolute top-1/4 left-1/4 w-96 h-96 bg-gradient-to-br from-blue-200/20 to-purple-200/20 dark:from-blue-500/10 dark:to-purple-500/10 rounded-full blur-3xl animate-pulse"></div>
      <div class="absolute bottom-1/4 right-1/4 w-96 h-96 bg-gradient-to-br from-purple-200/20 to-blue-200/20 dark:from-purple-500/10 dark:to-blue-500/10 rounded-full blur-3xl animate-pulse delay-1000"></div>
    </div>
    
    <!-- Pattern Overlay -->
    <div class="absolute inset-0 bg-[linear-gradient(30deg,#fff_12%,transparent_12.5%,transparent_87%,#fff_87.5%,#fff_100%)] dark:bg-[linear-gradient(30deg,#000_12%,transparent_12.5%,transparent_87%,#000_87.5%,#000_100%)] bg-[length:20px_20px] opacity-[0.15] dark:opacity-20"></div>
  </div>

  <div class="container mx-auto px-6 relative">
    <!-- Main Title Section -->
    <div class="text-center mb-16 max-w-4xl mx-auto">
      <div>
        <Badge text={translations?.badge || 'Multilingual Support'} />
      </div>

      <h1 class="text-5xl md:text-5xl font-bold mb-8 bg-clip-text text-transparent bg-gradient-to-r from-blue-600 to-purple-600 dark:from-blue-400 dark:to-purple-400 leading-tight tracking-tight animate-gradient">
        {translations?.title || 'Creating Multilingual Websites for a Global Audience'}
      </h1>
      <p class="text-xl md:text-xl text-gray-600 dark:text-gray-300 font-medium leading-relaxed max-w-3xl mx-auto tracking-normal">
        {translations?.description || 'We specialize in designing websites that speak your customers\' language, literally. With our multilingual support, reach audiences across different cultures and regions.'}
      </p>
    </div>

   
    <!-- Infinite Scroll Technology Logos -->
    <div class="relative w-full overflow-hidden py-12">
      <!-- First Row -->
      <div class="slider">
        <div class="slide-track">
          {[...technologies, ...technologies].map((tech, index) => (
            <div class="slide">
              <div class="w-32 h-32 rounded-2xl bg-white/50 dark:bg-gray-800/50 p-6 backdrop-blur-sm border border-gray-200/50 dark:border-gray-700/50 hover:scale-110 transition-transform duration-300 flex items-center justify-center mx-8">
                <i class={`${tech.icon} text-5xl text-blue-600/80 dark:text-blue-400/80`}></i>
              </div>
            </div>
          ))}
        </div>
      </div>

      <!-- Second Row -->
      <div class="slider mt-12">
        <div class="slide-track-reverse">
          {[...technologies, ...technologies].map((tech, index) => (
            <div class="slide">
              <div class="w-32 h-32 rounded-2xl bg-white/50 dark:bg-gray-800/50 p-6 backdrop-blur-sm border border-gray-200/50 dark:border-gray-700/50 hover:scale-110 transition-transform duration-300 flex items-center justify-center mx-8">
                <i class={`${tech.icon} text-5xl text-purple-600/80 dark:text-purple-400/80`}></i>
              </div>
            </div>
          ))}
        </div>
      </div>
    </div>
  </div>
</section>

<style>
  @keyframes gradient {
    0% { background-position: 0% 50%; }
    50% { background-position: 100% 50%; }
    100% { background-position: 0% 50%; }
  }

  .animate-gradient {
    background-size: 200% auto;
    animation: gradient 8s ease infinite;
  }

  @keyframes pulse {
    0%, 100% { opacity: 0.4; }
    50% { opacity: 0.6; }
  }

  .animate-pulse {
    animation: pulse 4s cubic-bezier(0.4, 0, 0.6, 1) infinite;
  }

  .delay-1000 {
    animation-delay: 1s;
  }

  .font-inter {
    font-family: 'Inter', sans-serif;
  }

  .slider {
    position: relative;
    width: 100%;
    height: auto;
    overflow: hidden;
  }

  .slide-track {
    display: flex;
    width: calc(160px * 20); /* Adjust based on slide width */
    animation: scroll 40s linear infinite;
  }

  .slide-track-reverse {
    display: flex;
    width: calc(160px * 20); /* Adjust based on slide width */
    animation: scroll-reverse 40s linear infinite;
  }

  .slide {
    flex: 0 0 auto;
  }

  @keyframes scroll {
    0% {
      transform: translateX(0);
    }
    100% {
      transform: translateX(calc(-160px * 10)); /* Half of the total width */
    }
  }

  @keyframes scroll-reverse {
    0% {
      transform: translateX(calc(-160px * 10)); /* Half of the total width */
    }
    100% {
      transform: translateX(0);
    }
  }

  /* Pause animation on hover */
  .slide-track:hover,
  .slide-track-reverse:hover {
    animation-play-state: paused;
  }
</style>

<script>
  const section = document.getElementById('localized-section') as HTMLElement;
  const button = document.getElementById('toggle-language') as HTMLButtonElement;
  const content = document.getElementById('content') as HTMLDivElement;
  const title = document.getElementById('title') as HTMLHeadingElement;
  const description = document.getElementById('description') as HTMLParagraphElement;

  if (!section || !button || !content || !title || !description) {
    console.error('Required DOM elements not found');
    throw new Error('Required DOM elements not found');
  }

  const englishContent = {
    title: "Welcome to Our Website",
    description: "Explore the best services we have to offer.",
    alignment: "text-left",
  } as const;

  const arabicContent = {
    title: "مرحبًا بكم في موقعنا",
    description: "اكتشف أفضل الخدمات التي نقدمها.",
    alignment: "text-right",
  } as const;

  let isEnglish = true;

  button.addEventListener("click", () => {
    // Add fade-out effect
    content.style.opacity = "0";
    
    setTimeout(() => {
      if (isEnglish) {
        // Switch to Arabic
        section.setAttribute("dir", "rtl");
        content.classList.replace("text-left", "text-right");
        title.textContent = arabicContent.title;
        description.textContent = arabicContent.description;
        button.textContent = "Switch to English";
      } else {
        // Switch to English
        section.setAttribute("dir", "ltr");
        content.classList.replace("text-right", "text-left");
        title.textContent = englishContent.title;
        description.textContent = englishContent.description;
        button.textContent = "Switch to Arabic";
      }
      
      // Add fade-in effect
      content.style.opacity = "1";
      isEnglish = !isEnglish;
    }, 300);
  });
</script>